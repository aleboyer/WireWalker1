      function sigma = dense(T,S,P)                                                     %     function sigma = dense(T,S,P)                                                     %----------------------------------------------------------------------%                 (JERRY SMITH, NOV. 1982)                                      % RETURNED VALUE IS IN SIGMA UNITS (RO-1000.KG/M.^3).                           % THIS FUNCTION EVALUATES THE DENSITY OF SEAWATER AT THE GIVEN T,S,P            % USING THE 1980 INTERNATIONAL EQUATION OF STATE OF SEAWATER.                   % REFERENCES:  UNESCO TECHNICAL PAPERS IN MARINE SCIENCE, NO.36, 1981.          %              MILLERO & POISSON, DEEP SEA RES. 28A(6):625-629, 1981.           %              MILLERO & AL., DEEP SEA RES. 27A( ):255-264, 1980.               %                                                                               % T IS IN DEGREES CELSIUS                                                       % S IS THE 'PRACTICAL SALINITY', TYPICAL OCEAN VALUE IS 35.                     %   .^REFERENCES CONCERNING 'THE PRACTICAL SALINITY SCALE 1978':                %               THE ABOVE UNESCO REPORT                                         %               LEWIS AND PERKIN, DEEP SEA RES.28A:307-328, 1981.               % P IS IN BARS, BUT P=0. ACTUALLY MEANS 1 STANDARD ATMOSPHERE.                  % DENSITY IS IN KG/METERS-CUBED, TYPICAL VALUES ARE NEAR 1000.                  %----------------------------------------------------------------------         %                                                                                     T1=T;                                                                           T2=T1.*T1 ;                                                                       T3=T2.*T1 ;                                                                       T4=T3.*T1 ;                                                                       T5=T4.*T1 ;                                                                 %                                                                                     S1=S ;                                                                           S15=S1.^1.5 ;                                                                   S2 =S1.^2 ;                                                                %                                                                                     P1=P ;                                                                           P2=P1.^2 ;                                                                 %----------------------------------------------------------------------         % EACH COLUMN CONTAINS COEFFICIENTS OF 1, T, T.^2, T.^3, T.^4, T.^5;            % EACH ROW CONTAINS COEFFICIENTS OF:                                            %                    1             S            S.^3/2        S.^2              %-----------------------------------------------------------------------              SIGT=     -0.157406    +8.24493E-1.*S1 -5.72466E-3.*S15+4.8314E-4.*S2 ...                 +T1.*( 6.793952E-2  -4.0899E-3 .*S1  +1.0227E-4.*S15)             ...                 +T2.*(-9.095290E-3  +7.6438E-5 .*S1  -1.6546E-6.*S15)             ...                 +T3.*( 1.001685E-4  -8.2467E-7 .*S1)                             ...                 +T4.*(-1.120083E-6  +5.3875E-9 .*S1)                             ...                 +T5.*( 6.536332E-9)                                             ;       %--                                                                                   CK0=      1.965221E+4  +5.46746E+1.*S1  +7.944E-2 .*S15  ...                             +T1.*( 1.484206E+2  -6.03459E-1.*S1  +1.6483E-2.*S15) ...                             +T2.*(-2.327105E0   +1.09987E-2.*S1  -5.3009E-4.*S15) ...                             +T3.*( 1.360477E-2  -6.1670E-5 .*S1)                 ...                             +T4.*(-5.155288E-5)                                 ;                   %--                                                                                   CKP= P1.*(  3.239908E0  +2.2838E-3 .*S1  +1.91075E-4.*S15 ...                              +T1.*( 1.43713E-3  -1.0981E-5 .*S1)                 ...                              +T2.*( 1.16092E-4  -1.6078E-6 .*S1)                 ...                              +T3.*(-5.77905E-7))                                ;                   %--                                                                                   CKP2= P2.*( 8.50935E-5  -9.9348E-7 .*S1   ...                                             +T1.*(-6.12293E-6  +2.0816E-8 .*S1)  ...                                             +T2.*( 5.27870E-8  +9.1697E-10.*S1)) ;                                  %                                                                               % NOW EVALUATE RO(P)= RO(0)/(1-P/CK),  WHERE CK= CK0 + CKP + CKP2,              % AND RO= 1000.+SIGT IN KG/M.^3.                                                %                                                                                     RO = (1000.+SIGT)./(1.-P1./(CK0+CKP+CKP2)) ;                                         sigma = RO-1000. ;                                                              